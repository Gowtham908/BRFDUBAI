create or replace PROCEDURE BRF40_DETAIL_PROCEDURE (REPORT_DATE VARCHAR2) IS
   v_report_date   DATE := TO_DATE(REPORT_DATE, 'DD-MM-YYYY');
BEGIN
   -- Delete from BRF40_DETAILTABLE where REPORT_DATE = V_REPORT_DATE;
   -- Commit;

   INSERT INTO BRF40_DETAILTABLE
   (foracid, cust_id, ACCT_NAME, REPORT_DATE, REPORT_LABEL_1, REPORT_NAME_1, ACCT_CRNCY_CODE, REPORT_ADDL_CRITERIA_1,REPORT_ADDL_CRITERIA_2,REPORT_ADDL_CRITERIA_3, COUNTRY, act_balance_amt_lc,ASST_CLS,ASST_CATEGORY)
   SELECT foracid, CUST_ID, ACCT_NAME, REPORT_DATE, REPORT_LABEL_1, REPORT_NAME_1, ACCT_CRNCY_CODE, REPORT_ADDL_CRITERIA_1,REPORT_ADDL_CRITERIA_2,REPORT_ADDL_CRITERIA_3, COUNTRY, act_balance_amt_lc,ASST_CLS,ASST_CATEGORY
   FROM brf40A_mapping_table
   WHERE report_date = v_report_date AND REPORT_LABEL_1 IS NOT NULL;

   INSERT INTO BRF40_DETAILTABLE
   (foracid, cust_id, ACCT_NAME, REPORT_DATE, REPORT_LABEL_1, REPORT_NAME_1, ACCT_CRNCY_CODE, REPORT_ADDL_CRITERIA_1,REPORT_ADDL_CRITERIA_2,REPORT_ADDL_CRITERIA_3, COUNTRY, act_balance_amt_lc,ASST_CLS,ASST_CATEGORY)
   SELECT foracid, CUST_ID, ACCT_NAME, REPORT_DATE, REPORT_LABEL_1, REPORT_NAME_1, ACCT_CRNCY_CODE, REPORT_ADDL_CRITERIA_1,REPORT_ADDL_CRITERIA_2,REPORT_ADDL_CRITERIA_3, COUNTRY, act_balance_amt_lc,ASST_CLS,ASST_CATEGORY
   FROM brf40B_mapping_table
   WHERE report_date = v_report_date AND REPORT_LABEL_1 IS NOT NULL;

   COMMIT;
END;